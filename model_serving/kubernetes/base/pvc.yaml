apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: model-cache-pvc
  labels:
    app: model-serving
    component: storage
    storage-type: model-cache
spec:
  # ReadWriteOnce for local dev; use ReadWriteMany in production with NFS/EFS
  accessModes:
  - ReadWriteOnce

  # Use default storageClass for local dev; override to fast-ssd in production
  storageClassName: standard

  resources:
    requests:
      storage: 5Gi  # 5GB for local dev; increase to 500Gi in production

  volumeMode: Filesystem

---
apiVersion: v1
kind: PersistentVolumeClaim
metadata:
  name: engine-cache-pvc
  labels:
    app: model-serving
    component: storage
    storage-type: engine-cache
spec:
  accessModes:
  - ReadWriteOnce

  storageClassName: standard

  resources:
    requests:
      storage: 2Gi  # 2GB for local dev; increase to 200Gi in production

  volumeMode: Filesystem

---
# =============================================================================
# StorageClass definitions (examples - adjust for your cloud provider)
# =============================================================================

# Example for GKE (Google Kubernetes Engine)
---
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: fast-ssd
provisioner: pd.csi.storage.gke.io
parameters:
  type: pd-ssd
  replication-type: regional-pd  # For high availability
volumeBindingMode: WaitForFirstConsumer
allowVolumeExpansion: true
reclaimPolicy: Retain

# Example for EKS (Amazon Elastic Kubernetes Service)
---
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: fast-ssd-aws
provisioner: ebs.csi.aws.com
parameters:
  type: gp3
  iops: "16000"
  throughput: "1000"
  encrypted: "true"
volumeBindingMode: WaitForFirstConsumer
allowVolumeExpansion: true
reclaimPolicy: Retain

# Example for AKS (Azure Kubernetes Service)
---
apiVersion: storage.k8s.io/v1
kind: StorageClass
metadata:
  name: fast-ssd-azure
provisioner: disk.csi.azure.com
parameters:
  skuName: Premium_LRS
  cachingMode: ReadWrite
volumeBindingMode: WaitForFirstConsumer
allowVolumeExpansion: true
reclaimPolicy: Retain
